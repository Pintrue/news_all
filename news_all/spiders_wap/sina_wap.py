# -*- coding: utf-8 -*-

import json
import re
from scrapy import Request
from scrapy.conf import settings
from news_all.spider_models import NewsRSpider
from news_all.tools.html_clean import NewsBaseParser, img_fn
from news_all.tools.others import get_sub_str_ex


img_pattern = re.compile(r"""<img.*?(?:data-)?src=['"]((?!data\:).*?)['"].*?>""")


# <img src="data:image/png;base64,iVBORw" data-src="//n.sinaimg.cn/news/transform/360/
# w760h400/20190505/Nqee-hwfpcxp0374777.png" alt="" class="img_width"/>


class SinaWapParser(NewsBaseParser):
    """新浪客户端清洗类  图片链接获取data-src"""

    def image_clean(self, content, img_re=None):
        fr = re.finditer(img_pattern, content)
        media = {}
        new_content = ''
        # //z8.sinaimg.cn/auto/resize?img=http://f.sinaimg.cn/sports/transform/275/
        # w650h13225/20190506/dbf9-hwsffza3458329.jpg&amp;size=328_218, tried 3 times

        for i, j in enumerate(fr):
            media.setdefault("images", {})
            st = content.find(j.group())
            end = st + len(j.group())
            new_content += content[:st] + '<p>${{%s}}$</p>' % (i + 1)
            content = content[end:]
            imgurl = j.group(1) if '=http:' not in j.group(1) else next(get_sub_str_ex(j.group(1), 'img=', '&', greedy=False))
            media['images'][str(i + 1)] = {"src": img_fn(imgurl)}

        new_content += content
        new_content.replace('$$', '$<br>$')  # 连续2图片加换行
        return new_content, media


class SinaWapSpider(NewsRSpider):
    chinese_name = """新浪app"""
    name = 'sina_app'
    custom_settings = {'DOWNLOADER_MIDDLEWARES': settings.getdict('APP_DOWN')}
    mystart_urls = {
        'http://newsapi.sina.cn/?resource=feed&channel=news_jingyao&pullDirection=down&pullTimes=3&replacedFlag=1&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556268902&listCount=15&upTimes=0&downTimes=2&mpName=%E8%A6%81%E9%97%BB&seId=30acf8f41a&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=d83e5851e3&rand=99': 1069,
        # 要闻
        'http://newsapi.sina.cn/?resource=feed&channel=news_toutiao&pullDirection=down&pullTimes=2&replacedFlag=0&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556269556&listCount=17&upTimes=0&downTimes=1&mpName=%E6%8E%A8%E8%8D%90&seId=9997ae9f83&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=6c7a9d0bfa&rand=699': 1070,
        # 推荐
        'http://newsapi.sina.cn/?resource=feed&channel=news_sports&pullDirection=down&pullTimes=2&replacedFlag=0&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556269637&listCount=19&upTimes=0&downTimes=1&mpName=%E4%BD%93%E8%82%B2&seId=9997ae9f83&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=c6fb8bed5c&rand=243': 1071,
        # 体育
        'http://newsapi.sina.cn/?resource=feed&channel=news_ent&pullDirection=down&pullTimes=2&replacedFlag=0&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556269637&listCount=19&upTimes=0&downTimes=1&mpName=%E5%A8%B1%E4%B9%90&seId=9997ae9f83&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=d8b645e270&rand=743': 1073,
        # 娱乐
        'http://newsapi.sina.cn/?resource=feed&channel=news_finance&pullDirection=down&pullTimes=2&replacedFlag=0&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556269725&listCount=19&upTimes=0&downTimes=1&mpName=%E8%B4%A2%E7%BB%8F&seId=9997ae9f83&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=fba13361d5&rand=568': 1074,
        # 财经
        'http://newsapi.sina.cn/?resource=feed&channel=news_tech&pullDirection=down&pullTimes=3&replacedFlag=1&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556269755&listCount=13&upTimes=0&downTimes=2&mpName=%E7%A7%91%E6%8A%80&seId=9997ae9f83&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=4a2848658d&rand=3': 1075,
        # 科技
        'http://newsapi.sina.cn/?resource=feed&channel=news_mil&pullDirection=down&pullTimes=2&replacedFlag=0&loadingAdTimestamp=0&behavior=manual&lastTimestamp=1556269801&listCount=19&upTimes=0&downTimes=1&mpName=%E5%86%9B%E4%BA%8B&seId=9997ae9f83&deviceId=0569eb96f57f7348&from=603509A012&deviceIdV1=0569eb96f57f7348&weiboUid=&weiboSuid=&imei=869782026564222&wm=b207&chwm=15081_0001&oldChwm=15081_0001&osVersion=7.0&connectionType=2&resolution=1080x1920&city=&deviceModel=Xiaomi__Xiaomi__Mi+Note+2&location=&link=&mac=02%3A00%3A00%3A00%3A00%3A00&ua=Xiaomi-Mi+Note+2__sinanewslite__3.5.0__android__7.0&cpu=armeabi-v7a&osSdk=24&cmd_mac=&aId=01AtnMfhS7t35NL78uAa_1CGs6UurZxEGZp1Eo4Xf5TRC3mR8.&lDid=bf99b752-2dbe-4087-80de-9e6731b4de9d&accessToken=&token=zF4w3ZK9zXse3mTgoMwGn6llu5d8cUlxkbyUkf9E0WZH%2BYde4MaSM3KnV%2F6I6AH8&urlSign=1be9a90b2d&rand=209': 1077,
        # 军事

        # 扩展的栏目
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%81%A5%E5%BA%B7&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_health&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_5e6514df-1ece-422d-b277-d95cd6301701&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=3f6b1ccfdf&rand=277': 3559,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%81%A5%E8%BA%AB&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_slim&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_5c1d1daa-b995-46a5-a7af-91494433a2c4&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=40698334ab&rand=559': 3560,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%85%AB%E5%8D%A6&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_gossip&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_0b8d03e4-38fa-4c9c-9346-8ddc274e1a33&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=9904a3b125&rand=925': 3561,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%8A%A8%E6%BC%AB&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_cartoon&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_32929c2d-f983-46e4-8c6a-933845dfd933&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=70a2bff0e7&rand=464': 3562,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%8E%86%E5%8F%B2&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_history&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_b4058558-b07f-4462-98e0-d64f595ecb69&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=b94210ad64&rand=650': 3563,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%9B%BD%E9%99%85&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_inter&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_5fd2d62e-0a7d-4900-85fc-c4d1d08ab232&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=aa975b0193&rand=301': 3564,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%9B%BE%E7%89%87&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_pic&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_76b454bf-ccf0-43e0-be8e-96b4bbe92cbe&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=21&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=1558064201&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=4f5d9ed4c6&rand=616': 3565,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%A5%B3%E6%80%A7&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_eladies&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_f9240cf7-a3af-4695-9689-a5692328dd37&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=16e0fda917&rand=739': 3566,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%AE%A0%E7%89%A9&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_pets&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_ed8c3b13-101a-4790-85d9-1d39e92aa577&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=6c30cdc42b&rand=974': 3567,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E5%AE%B6%E5%B1%85&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_home&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_88402f6f-22a2-4744-92a0-3044c763306e&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=bde669c295&rand=529': 3568,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%88%BF%E4%BA%A7&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=house_beijing&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_5e5e95de-b2ec-456f-b3f3-6fb0294bc305&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=9efd6fd123&rand=505': 3569,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%90%9E%E7%AC%91&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_funny&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_fd2c8e40-41dd-4f3b-bb15-992b7c9bbab4&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=5716d771a2&rand=812': 3570,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%94%B6%E8%97%8F&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_collection&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_560372cf-9c7d-4177-944d-3ecc4a66701d&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=a3357d15f0&rand=463': 3571,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%94%BF%E5%8A%A1&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_zhengwu&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_2d61df06-13af-43da-b12f-479787047cad&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=3b99efefaf&rand=792': 3572,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%95%99%E8%82%B2&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_edu&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_f2488e99-b7fa-4409-89d8-858bd39900bb&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=8462c6d70d&rand=384': 3573,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%95%B0%E7%A0%81&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_digital&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_78091ab8-cdf0-4613-8543-5da44c6354d0&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=35789339ef&rand=106': 3574,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%96%B0%E6%97%B6%E4%BB%A3&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_shijiuda&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_6217d1f1-915a-408d-889e-91f14890024b&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=21&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=1558064179&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=357d37345b&rand=911': 3575,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%97%85%E6%B8%B8&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_travel&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_166aef04-dfb3-430b-aeb3-c51795ac61a8&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=a5deb48a0a&rand=92': 3576,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%97%B6%E5%B0%9A&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_fashion&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_89876298-d4ed-4931-8c7c-f1feb49088c8&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=18&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=1558064200&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=b8d3fd0f5c&rand=356': 3577,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%98%9F%E5%BA%A7&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_ast&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_6001e79e-91ca-4015-aa06-dbe8a94aefd1&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=f37f01e9e7&rand=995': 3578,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%B1%BD%E8%BD%A6&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_auto&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_ba31aa4c-9c6b-4f97-89a5-f048991ac4e5&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=18&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=1558064189&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=868016d095&rand=515': 3579,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E6%B8%B8%E6%88%8F&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_game&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_678dd92e-5d99-4207-bc5f-e317deeeb838&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=4f6508d239&rand=185': 3580,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E7%BE%8E%E9%A3%9F&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_food&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_7812ccca-bdc3-4da3-bb52-a8bd875ea26a&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=52657371bf&rand=480': 3581,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E8%82%B2%E5%84%BF&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_baby&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_21fed0a7-a446-4136-b5ae-6b68a3ce3af1&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=458ea60e68&rand=244': 3582,
    'http://newsapi.sina.cn/?resource=feed&mpName=%E8%A7%86%E9%A2%91&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_video&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_319e82a3-c3ea-4df1-80cb-d3157d541c33&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=13&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=1558064174&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=1f765be907&rand=788': 3583,
    'http://newsapi.sina.cn/?resource=feed&mpName=GIF&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_gif&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_83882c0e-9397-445b-aa73-af4ac097258f&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=e62ac01634&rand=369': 3584,
    'http://newsapi.sina.cn/?resource=feed&mpName=NBA&lDid=4415b204-b75f-4521-9953-cb961cc8dd2a&appVersion=7.15.0&oldChwm=12030_0002&upTimes=0&city=WMXX2972&loginType=1&prefetch=6&authToken=abc6a7d12ed40a0e56f80f3c5f676df5&channel=news_nba&link=&authGuid=6504680260523885301&ua=Xiaomi-Redmi+Pro__sinanews__7.15.0__android__6.0&deviceId=63b0bcbeb414f27f&connectionType=2&resolution=1080x1920&mac=02%3A00%3A00%3A00%3A00%3A00&weiboUid=6438008446&replacedFlag=0&osVersion=6.0&chwm=12030_0002&pullTimes=1&weiboSuid=46c8d9ef51&andId=46e5eea3b841a800&from=6000095012&sn=BMMVZPYTIFCMHQIR&behavior=auto&aId=01An0r-qYXInje8xktcccZgbPGsitV0q7LODaBlwTjW9sfbtU.&localSign=a_03dfaaf9-adc2-4876-9ea4-d75cd1843f1e&deviceIdV1=63b0bcbeb414f27f&todayReqTime=0&osSdk=23&abver=1556009534700150000&listCount=0&accessToken=2.00uFOhBHe3vYNC8b91d3eb02PIKiYB&downTimes=0&lastTimestamp=0&pullDirection=down&seId=d0b3a60dc7&imei=861603035854842&deviceModel=Xiaomi__Xiaomi__Redmi+Pro&location=39.921517%2C116.474111&authUid=6534993861919138913&loadingAdTimestamp=0&urlSign=d19e758524&rand=342': 3585,
    }

    parser = SinaWapParser()

    def parse(self, response):
        rs = json.loads(response.text)
        if rs.get('status') != 0:
            return self.produce_debugitem(response, 'json error')

        data = rs.get('data')
        feedlist_items = data.get('feed')

        for i in feedlist_items:
            news_url = i.get('link')
            if i.get("category") == "video":  # 排除视频
                continue
            pubtime = i.get('pubDate')

            # http://m.house.sina.com.cn/m.leju.com/?id=6536508484366938288&city=bj&site=tg&ctl=SinaApp&act=info&source=m_sina_appnews&source_ext=sina_app&fromsinago=1

            title = i.get('title')
            origin_name = i.get('source')
            yield Request(
                url=news_url,
                callback=self.parse_item,
                meta={'source_id': response.meta['source_id'], 'title': title, 'pubtime': pubtime,
                      'origin_name': origin_name,
                      'start_url_time': response.meta.get('start_url_time'), 'schedule_time': response.meta.get('schedule_time')}
            )

    def parse_item(self, response):
        # https://news.sina.cn/gn/2019-05-05/detail-ihvhiqax6676754.d.html?cre=tianyi&mod=f&loc=1&r=24&rfunc=15&tj=cxtoutiao&tr=24&fromsinago=1
        
        xp = response.xpath
        try:
            # https://sports.sina.cn/premierleague/mancity/2019-05-05/detail-ihvhiqax6731306.d.html?fromsinago=1
            # //article[@class='art_box']/section[@class='art_pic_card art_content']导致丢失图片
            # https://k.sina.cn/article_2101850115_p7d47b00302700fqx1.html?cre=tianyi&mod=ntech&loc=4&r=25&rfunc=15&tj=cxvertical_ntech&tr=0&fromsinago=1&http=fromhttp
            # 正文在@class='s_card'
            # 同时存在则都获取@class='art_box' or @class='s_card'
            content_div = xp("//article[@class='art_box' or @class='s_card']") or xp(
                '//div[@class="content b-txt1" or @id="j_articleContent"]') or xp('//div[@id="text_box"]')
            content, media, videos, video_cover = self.content_clean(content_div,
                                                                     kill_xpaths=['//*[@class="art_tit_h1"]',
                                                                                  '//*[@class="art_time"]',
                                                                                  '//div[@id="wx_pic"]',
                                                                                  '//img[@class="sharePic hide"]',
                                                                                  '//em[@class="weibo_img"]',
                                                                                  '//*[@class="weibo_detail"]',
                                                                                  '//*[contains(@class, "fl_popup")]',
                                                                                  '//*[@class="hd_h1"]',
                                                                                  '//*[@class="hd_h2"]',
                                                                                  '//*[text()="相关推荐"]/parent::*',
                                                                                  '//*[@class="da_h3"]'  # 去广告
                                                                                  '//*[contains(text(), "欢迎进入我的直播")]/text()',
                                                                                  '//a[@text(),"点击进入》》》"]',
                                                                                  '//section[@class="weibo_p"]/aside[@class="weibo_box"]',
                                                                                  '//footer[@class="most_info"]',
                                                                                  '//img[@h<200 or @wh>3',
                                                                                  '//img[re:match(@src, "/\d+/w\d+h\d{1,2}/\d{8}/")]',
                                                                                  # 去小图
                                                                                  '//img[re:match(@src, "/\d+/w\d+h1\d\d/\d{8}/")]',
                                                                                  '//a[@class="look_sub j_article_wbreco"]',
                                                                                  ],
                                                                     )
        except:
            return self.produce_debugitem(response, "xpath error")

        return self.produce_item(
            response=response,
            title=response.request.meta['title'],
            pubtime=response.request.meta['pubtime'],
            origin_name=response.request.meta['origin_name'],
            content=content,
            media=media
        )

    # 放弃http://db.auto.sina.cn/photo/g135734-2.html?cre=tianyi&mod=npic&loc=5&r=0&rfunc=80&tj=cxvertical_npic&tr=12&fromsinago=1
